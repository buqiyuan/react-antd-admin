!function(){function e(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(u){l=!0,a=u}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||n(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||n(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t,n,r,a,i,o){try{var l=e[i](o),u=l.value}catch(c){return void n(c)}l.done?t(u):Promise.resolve(u).then(r,a)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){l(i,r,a,o,u,"next",e)}function u(e){l(i,r,a,o,u,"throw",e)}o(void 0)}))}}var c=document.createElement("style");c.innerHTML=".separator{position:absolute;top:0;right:0;display:flex;width:14px;height:100%;cursor:col-resize;background-color:#fff;box-shadow:-4px -2px 4px -5px rgba(0,0,0,.35),4px 3px 4px -5px rgba(0,0,0,.35);align-items:center;justify-content:center}.separator i{width:1px;height:14px;margin:0 1px;background-color:#e9e9e9}._dept-tree-panel-container_iyz7m_1 ._header_iyz7m_1{display:flex;justify-content:space-between}._dept-tree-panel-container_iyz7m_1 ._header_iyz7m_1 ._title_iyz7m_5{font-size:14px;font-weight:500}._dept-tree-panel-container_iyz7m_1 ._header_iyz7m_1 ._operate-wrapper_iyz7m_9{display:flex}._dept-tree-panel-container_iyz7m_1 ._header_iyz7m_1 ._operate-wrapper_iyz7m_9 ._tool-item_iyz7m_12{padding:2px 4px;cursor:pointer}\n",document.head.appendChild(c),System.register(["./role-legacy.f5d7fd74.js","./Table-legacy.da54ef58.js","./vendor-legacy.eb2932d9.js","./user-legacy.2d497d7a.js","./index-legacy.c78219f2.js","./throttle-legacy.308709d4.js","./index-legacy.cf65b0d7.js","./map-legacy.e4507e83.js"],(function(n){"use strict";var r,a,o,l,c,s,d,p,m,f,h,v,y,g,b,x,w,_,k,S,I,R,j,C,E,z,O,N,A,P,T,D,q,F,M,L,V,H,K,G,W,X,U;return{setters:[function(e){r=e.P,a=e.u},function(e){o=e.M,l=e.P,c=e.a},function(e){s=e.r,d=e.j,p=e.c,m=e.l,f=e.aH,h=e.A,v=e.T,y=e.aS,g=e.m,b=e.aT,x=e.P,w=e.aF,_=e.aU,k=e.aV,S=e.D,I=e.M,R=e.aW,j=e.aX,C=e.aY,E=e.ay,z=e.C,O=e.aZ,N=e.a_,A=e.a$,P=e.B},function(e){T=e.s,D=e.P,q=e.a,F=e.b},function(e){M=e.r},function(e){L=e.t},function(e){V=e.u,H=e.c,K=e.g,G=e.a,W=e.d,X=e.b,U=e.P},function(){}],execute:function(){function $(e){return M({url:T.page,method:"post",data:e})}function B(e){return M({url:T.add,method:"post",data:e},{successMsg:"创建用户成功"})}function Y(e){return M({url:T.update,method:"post",data:e},{successMsg:"修改用户成功"})}var Z=m,J=Z.Sider,Q=Z.Content,ee=function(e){var t,n=e.children,r=e.assideRender,a=e.assideWidth,i=void 0===a?280:a,o=e.onSeparatorDrag,l=L((function(e){requestAnimationFrame((function(){var n=i+e.clientX-t;null==o||o(Math.max(n,10))}))}),20),u=s.exports.useCallback((function(){document.documentElement.style.userSelect="unset",document.documentElement.removeEventListener("mousemove",l),document.documentElement.removeEventListener("mouseup",u)}),[l]);return d(f,{style:{margin:"20px"},bordered:!1,children:p(m,{children:[r?p(J,{width:i,theme:"light",style:{paddingRight:"20px"},children:[r,p("div",{className:"separator",onMouseDown:function(e){t=e.clientX,document.documentElement.style.userSelect="none",document.documentElement.addEventListener("mousemove",l),document.documentElement.addEventListener("mouseup",u)},children:[d("i",{}),d("i",{})]})]}):null,d(m,{children:d(Q,{children:n})})]})})},te=[{title:"头像",width:80,dataIndex:"headImg",render:function(e,t){return d(h,{src:t.headImg})}},{title:"姓名",width:120,dataIndex:"name",align:"center"},{title:"用户名",width:120,align:"center",dataIndex:"username"},{title:"所在部门",dataIndex:"departmentName",align:"center",width:180},{title:"所属角色",dataIndex:"roleNames",align:"center",width:220,render:function(e,t){return d(y,{children:t.roleNames.map((function(e){return d(v,{color:"success",children:e},e)}))})}},{title:"呢称",width:120,align:"center",dataIndex:"nickName"},{title:"邮箱",width:120,align:"center",dataIndex:"email"},{title:"手机",width:120,align:"center",dataIndex:"phone"},{title:"备注",width:120,align:"center",dataIndex:"remark"},{title:"状态",dataIndex:"status",width:100,render:function(e,t){var n=1===t.status;return d(v,{color:n?"success":"red",children:n?"启用":"禁用"})}}],ne="_dept-tree-panel-container_iyz7m_1",re="_header_iyz7m_1",ae="_title_iyz7m_5",ie="_operate-wrapper_iyz7m_9",oe="_tool-item_iyz7m_12",le=function(e){var t,n=e.currentDept,a=e.deptTree,l=e.onCancel,c=e.onSuccess,m=e.visible,f=s.exports.useRef();return s.exports.useEffect((function(){var e=function(){var e=u(regeneratorRuntime.mark((function e(){var t,r,a,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n||!n.key||!Number.isInteger(n.key)){e.next=6;break}return e.next=3,K({departmentId:n.key});case 3:a=e.sent,i=a.department,null===(t=f.current)||void 0===t||t.setFieldsValue({parentId:null!==(r=i.parentId)&&void 0!==r?r:-1,name:i.name,orderNum:i.orderNum});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();m&&e()}),[n,m]),p(o,{formRef:f,title:"".concat(null!=n&&n.key?"编辑":"新增","部门"),visible:m,modalProps:{onCancel:l},onFinish:(t=u(regeneratorRuntime.mark((function e(t){var r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n||!n.key||!Number.isInteger(n.key)){e.next=9;break}return a=i(i({},t),{},{id:null==n?void 0:n.key}),e.next=4,V(a);case 4:e.sent,g.success("修改部门成功"),e.next=14;break;case 9:return e.next=11,H(t);case 11:e.sent,g.success("新增部门成功");case 14:return null===(r=f.current)||void 0===r||r.resetFields(),c(),e.abrupt("return",!0);case 17:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)}),children:[d(r,{name:"name",label:"部门名称",placeholder:"请输入部门名称",rules:[{required:!0,message:"请输入部门名称!"}]}),d(x.Item,{name:"parentId",label:"上级部门",rules:[{required:!0,message:"请选择上级部门!"}],children:d(b,{style:{width:"100%"},dropdownStyle:{maxHeight:400,overflow:"auto"},treeData:[{key:-1,title:"#",children:a}],placeholder:"请选择所属部门",treeDefaultExpandAll:!0})}),d(D,{label:"排序",name:"orderNum",min:0})]})},ue=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t.filter((function(e){return e.parentId===n})).map((function(n){return{title:n.name,key:n.id,value:n.id,children:e(t,n.id)}}))},ce=function e(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return n.reduce((function(n,r){var a=[r.key];return r.children&&a.push.apply(a,t(e(r.children))),n.concat(a)}),r)},se=function(t){var n=e(s.exports.useState(!1),2),r=n[0],i=n[1],o=e(s.exports.useState([]),2),l=o[0],c=o[1],m=e(s.exports.useState([]),2),f=m[0],h=m[1],v=e(s.exports.useState(),2),g=v[0],b=v[1],x=e(a(u(regeneratorRuntime.mark((function e(){var n,r,a,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,G();case 2:return r=e.sent,a=ue(r),i=a.map((function(e){return e.key})),o=null===(n=r.find((function(e){return Object.is(e.parentId,null)})))||void 0===n?void 0:n.id,setTimeout((function(){var e;h(o?[o]:[]),c(i),null===(e=t.onDeptTreeChange)||void 0===e||e.call(t,a)})),e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)}))),[]),2),N=x[0],A=x[1];s.exports.useEffect((function(){A()}),[A]);var P=function(){b(void 0),i(!1)};return p(E,{children:[p("div",{className:ne,children:[p("div",{className:re,children:[d("div",{className:ae,children:"组织架构"}),p("div",{className:ie,children:[d("div",{className:oe,children:d(w,{title:"新增部门",children:d(_,{onClick:function(){i(!0),b(void 0)}})})}),d("div",{className:oe,children:d(w,{title:"点击刷新",children:d(k,{onClick:A,spin:N.loading})})})]})]}),d(C,{className:"draggable-tree",selectedKeys:f,expandedKeys:l,blockNode:!0,treeData:N.value,onSelect:function(e,n){var r;h(e),null===(r=t.onSelect)||void 0===r||r.call(t,ce(n.selectedNodes))},onExpand:function(e){c(e)},titleRender:function(e){return d(S,{overlay:p(I,{onClick:function(e){return e.domEvent.stopPropagation()},children:[d(I.Item,{children:p(y,{size:"large",align:"center",onClick:function(){b(e),i(!0)},children:[d("span",{children:"编辑"}),d(R,{style:{verticalAlign:"0"}})]})},"1"),d(I.Item,{onClick:function(){return t=e.key,void z.confirm({title:"您确定要删除该部门吗?",icon:d(O,{}),centered:!0,onOk:(n=u(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W({departmentId:t});case 2:return e.abrupt("return",A());case 3:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})});var t,n},children:p(y,{size:"large",align:"center",children:[d("span",{children:"删除"}),d(j,{style:{verticalAlign:"0"}})]})},"2")]}),trigger:["contextMenu"],children:d("div",{children:e.title})})}})]}),d(le,{visible:r,deptTree:N.value,onSuccess:function(){P(),A()},onCancel:P,currentDept:g})]})},de=function(e){var t,n,a=e.visible,c=e.deptTree,m=e.detail,f=e.onCancel,h=e.onSuccess,v=s.exports.useRef();return s.exports.useEffect((function(){var e,t,n=function(){var e=u(regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==m||!m.id){e.next=6;break}return e.next=3,a={userId:m.id},M({url:T.info,method:"get",params:a});case 3:n=e.sent,r=n.roles,null===(t=v.current)||void 0===t||t.setFieldsValue({roles:r});case 6:case"end":return e.stop()}var a}),e)})));return function(){return e.apply(this,arguments)}}();a&&n(),null===(e=v.current)||void 0===e||e.resetFields(),null===(t=v.current)||void 0===t||t.setFieldsValue(i({},m))}),[m,a]),p(o,{formRef:v,title:"".concat(null!=m&&m.id?"编辑":"新增","用户"),width:840,visible:a,layout:"horizontal",modalProps:{onCancel:f},onFinish:(n=u(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==m||!m.id){e.next=9;break}return n=i(i({},t),{},{id:m.id}),e.next=4,Y(n);case 4:e.sent,g.success("修改用户成功"),e.next=14;break;case 9:return e.next=11,B(t);case 11:e.sent,g.success("新增用户成功");case 14:return h(),e.abrupt("return",!0);case 16:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)}),children:[d(x.Item,{name:"departmentId",label:"所属部门",rules:[{required:!0,message:"请选择所属部门!"}],children:d(b,{style:{width:"100%"},dropdownStyle:{maxHeight:400,overflow:"auto"},treeData:c,placeholder:"请选择所属部门",treeDefaultExpandAll:!0})}),d(q,{mode:"multiple",name:"roles",label:"所属角色",rules:[{required:!0,message:"请选择所属角色!"}],request:(t=u(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,X();case 2:return t=e.sent,e.abrupt("return",t.map((function(e){return{label:e.name,value:e.id}})));case 4:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})}),d(r,{name:"username",label:"用户名",tooltip:"由6位以上的数字和字母组成",placeholder:"请输入用户名",rules:[{required:!0,message:"请输入用户名!"}]}),p(l.Group,{children:[d(r,{width:"md",name:"name",label:"姓名",placeholder:"请输入姓名",rules:[{required:!0,message:"请输入姓名!"}]}),d(r,{width:"md",name:"nickName",label:"昵称",placeholder:"请输入昵称"})]}),p(l.Group,{children:[d(r,{width:"md",name:"email",label:"邮箱",placeholder:"请输入邮箱"}),d(r,{width:"md",name:"phone",label:"手机",placeholder:"请输入手机"})]}),d(U,{name:"remark",label:"备注"}),d(F.Group,{name:"status",label:"状态",initialValue:(null==m?void 0:m.status)||1,options:[{label:"启用",value:1},{label:"禁用",value:0}]})]})};n("default",(function(){var t,n,a=e(s.exports.useState(),2),i=a[0],l=a[1],m=e(s.exports.useState(!1),2),f=m[0],h=m[1],v=e(s.exports.useState(!1),2),b=v[0],x=v[1],w=e(s.exports.useState(260),2),_=w[0],k=w[1],S=e(s.exports.useState([]),2),I=S[0],R=S[1],j=e(s.exports.useState(),2),C=j[0],E=j[1],z=s.exports.useRef(),O=function(){var e;return null==z||null===(e=z.current)||void 0===e?void 0:e.reload()},D=function(e){var t,n=Array.isArray(e)?e.map((function(e){return e.id})):[e.id];(t={userIds:n},M({url:T.delete,method:"post",data:t})).finally(O)},q=function(){x(!1),l(void 0)},F=[].concat(te,[{title:"操作",width:200,key:"option",valueType:"option",align:"center",fixed:"right",render:function(e,t){return[d("a",{onClick:function(){l(t),h(!0)},children:"编辑"},"edit"),d("a",{onClick:function(){l(t),x(!0)},children:"改密"},"update.psw"),d(A,{placement:"left",title:"你确定要删除该用户吗?",onConfirm:function(){return D(t)},children:d("a",{children:"删除"})},"del")]}}]);return p(ee,{onSeparatorDrag:function(e){return k(e)},assideWidth:_,assideRender:d(se,{onDeptTreeChange:function(e){R(e)},onSelect:function(e){E({departmentIds:e.length?e:void 0})}}),children:[d(c,{actionRef:z,params:C,columns:F,size:"small",toolbar:{title:"用户管理",tooltip:"请不要随意删除用户，避免到影响其他用户的使用。"},request:(n=u(regeneratorRuntime.mark((function e(t){var n,r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$({page:t.current,limit:t.pageSize,departmentIds:t.departmentIds});case 2:return n=e.sent,r=n.list,a=n.pagination,e.abrupt("return",{data:r,success:!0,total:null==a?void 0:a.total});case 7:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)}),rowSelection:{selections:[N.SELECTION_ALL,N.SELECTION_INVERT]},tableAlertRender:function(e){var t=e.selectedRowKeys,n=e.onCleanSelected;return p(y,{children:[p("span",{children:["已选 ",t.length," 项"]}),d("a",{onClick:n,children:"取消选择"})]})},tableAlertOptionRender:function(e){var t=e.selectedRows;return d(A,{title:"你确定要删除所选角色吗?",onConfirm:function(){return D(t)},children:d("a",{children:"删除"})},"del")},scroll:{x:1300},search:!1,rowKey:"id",headerTitle:d(P,{type:"primary",onClick:function(){l(void 0),h(!0)},children:"新增"})}),d(de,{deptTree:I,detail:i,visible:f,onSuccess:function(){h(!1),l(void 0),O()},onCancel:function(){h(!1),l(void 0)}}),d(o,{visible:b,title:"更改管理员(".concat(null==i?void 0:i.username,")密码"),layout:"horizontal",modalProps:{onCancel:q},onFinish:(t=u(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==i||!i.id){e.next=6;break}return e.next=3,n={userId:i.id,password:t.password},M({url:T.password,method:"post",data:n},{successMsg:"操作成功"});case 3:return g.success("更改成功！"),q(),e.abrupt("return",!0);case 6:return e.abrupt("return",!1);case 7:case"end":return e.stop()}var n}),e)}))),function(e){return t.apply(this,arguments)}),children:d(r,{name:"password",label:"新密码",placeholder:"请输入新密码",rules:[{required:!0,message:"请输入新密码!"}]})},"up")]})}))}}}))}();
